# How to run hdf_visualizer.ipynb

This notebook can be divided into several parts: 

1. Installing the requirements
2. Visualize HDF5 Files
3. Search & Download using EUMDAC API
4. Extract Geo-Coordinates
5. Folium Map Generator

## 1. Installing the requirements

We assume you have installed python 3 in a venv ~/ENV3

```bash
source ~/ENV3/bin/activate
```

When using jupyter, pycharm or vscode, make sure to set the python interpreter 
accordingly.

This program requires the instalation of the following packages. 

```bash
pip install jupyterlab
pip install jupyter
```

The rest of the requirements are included in the ipython notebook 
in the first few cells. 

## 2. Visualize HDF5 Files

This part is straightforward. It takes directory path as input and generate a 
dataframe and subplot of 10*10 matrices as output.

### 2.1 Input: (Cell #3) data_path1, data_path2

* Here the program takes two directories containing day and night inference 
* hdf5 files as data_path1, data_path2, respectively
* Make sure to adjust the path accordingly; that's all you need to do here

### 2.2 Output1: (dataframe) inference_df

inference_df is the main dataframe throughout this notebook.

### 2.3 Output2: (subplot 10*10 matrix) generated by SLSTRFileNameParser.plot_image_matrix([dataframe])



## 3. Search & Download using EUMDAC API

Before diving in, make sure you have register an account at 
[EUMETSAT](https://data.eumetsat.int/data/map/EO:EUM:DAT:0615?start=2020-02-15T22:29:06.913Z&end=2020-02-16T22:29:06.913Z&sort=start,time,0), as you will need api token to download data.

Follow the instructions to create a new account

Now login with your username and password





### 3.1 API Token (Cell #2 of Part TWO)

Gte the API key from 

<https://api.eumetsat.int/api-key/>


export ESAT="~/esat"

You will need to copy the following fields to your computer

* consumer_key
* consumer_secret

store them in the files 

mkdir $ESAT
$ESAT/.consumer_key
$ESAT/.consumer_secret

You can find these information after you logged in.
The token would auto refresh.

mkdir $ESAT/data

### 3.2 download needed files

TBD ???



### 3.3 Adjust Your Working Directory

* Part TWO will create a directory named: 'ssts-additional-info/' on your 
  current working dir. Make sure this dir does not already exist.
  Under 'ssts-additional-info/', 100 directories will be further created for 
  each inference hdf files to store two files: xfdumanifest.xml (which 
  contains geo-coordinates), browse.jpg (raw image)
  After one SUCCESSFUL execution of Part TWO, there is no need to rerun 
  this part. 

## 4. Extract Geo-Coordinates

There is nothing you need to change in this part. Just run. 

## 5. Folium Map Generator

There is again nothing you need to change in this part. Just run.

Note: This part will take quite a while.
After execution is done, a folium map (framed with geo-coordinates) will be 
created and save to the 100 folders in 'ssts-additional-info/'